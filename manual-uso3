Manual de Uso: Asistente de Cultivos (v15.1)
El Asistente de Cultivos es una aplicaci√≥n de escritorio dise√±ada para gestionar, planificar y analizar tus proyectos agr√≠colas, combinando la gesti√≥n de datos con capacidades financieras y de an√°lisis avanzado.

1. ‚öôÔ∏è Requisitos y Ejecuci√≥n
Tarea	Instrucci√≥n
Archivos Necesarios	cultivos.py (c√≥digo), ventas_mensuales.csv (datos de an√°lisis), cultivos.json (datos guardados autom√°ticamente). Deben estar en la misma carpeta.
Librer√≠as	Necesitas tener instaladas: tkinter (incluido en Python), pandas, matplotlib, y tkcalendar.
Ejecuci√≥n	Abre la terminal/PowerShell en la carpeta del proyecto y ejecuta: python cultivos.py

Exportar a Hojas de c√°lculo

2. üìù Panel Izquierdo: A√±adir/Editar Cultivo
Este panel se utiliza para ingresar y modificar la informaci√≥n detallada de cada proyecto de cultivo.

Secci√≥n	Funcionalidad
Nombre	Nombre del cultivo (ej: "Tomate Cherry").
Zona	Permite clasificar el cultivo por ubicaci√≥n (ej: "Invernadero", "Zona A").
Fechas	Usa los botones "Elegir Fecha..." para seleccionar la fecha de Siembra y Cosecha con un calendario interactivo.
Costo (‚Ç¨)	El precio o costo asociado con la compra de semillas, tierra, etc.
Venta Est. (‚Ç¨)	El precio de venta estimado o el ingreso potencial que esperas obtener.
Notas	Campo opcional para informaci√≥n adicional sobre cuidados, plagas, etc.
Botones	"A√±adir a la Lista" / "Guardar Cambios": Guarda el nuevo cultivo o aplica modificaciones al seleccionado. "Limpiar Campos": Borra el contenido de los formularios.

Exportar a Hojas de c√°lculo

3. üìä Panel Derecho: Gesti√≥n y Reportes
Este panel muestra un resumen de todos tus cultivos y contiene las herramientas de reporte y an√°lisis.

A. Resumen Financiero Potencial
Muestra una suma r√°pida de la salud financiera de todos tus cultivos activos:

Costo Total: Suma de todos los costos de compra.

Venta Est. Total: Suma de todas las ventas estimadas.

Margen Potencial: La diferencia entre la venta total y el costo total.

B. Lista de Cultivos (Treeview)
Muestra todos los cultivos en formato de tabla, destacando informaci√≥n clave:

Columna	Descripci√≥n	Indicador Visual
Cultivo / Zona	El nombre y la ubicaci√≥n de tu proyecto.	
Siembra / Cosecha	Las fechas clave.	
Costo / Venta / Margen	Los valores financieros individuales.	
Faltan	Muestra los d√≠as restantes hasta la cosecha.	Verde: Faltan d√≠as. Amarillo/Negro: ¬°Cosecha Hoy! Gris: Ya Cosechado.

Exportar a Hojas de c√°lculo

C. Botones de Gesti√≥n y An√°lisis
Bot√≥n	Funcionalidad	M√≥dulo(s) Clave
‚úèÔ∏è Editar Seleccionado	Carga la informaci√≥n del cultivo seleccionado en el panel izquierdo para su edici√≥n.	Tkinter
‚ùå Eliminar	Elimina permanentemente el cultivo seleccionado tras pedir confirmaci√≥n.	Tkinter
üì§ Exportar Cultivos CSV	Exporta todos los datos de tus cultivos a un archivo CSV con delimitador ; (punto y coma).	CSV, Tkinter
üìà Analizar Ventas Externas	¬°NUEVA FUNCI√ìN! Carga y procesa el archivo ventas_mensuales.csv para generar an√°lisis detallados.	Pandas, Matplotlib

Exportar a Hojas de c√°lculo

4. üìà Funcionalidad de An√°lisis Avanzado
Al hacer clic en "Analizar Ventas Externas", la aplicaci√≥n:

Valida el archivo: Verifica que ventas_mensuales.csv exista.

Calcula M√©tricas: Imprime en la consola las ventas totales, promedio, m√°xima y m√≠nima.

Muestra Gr√°ficos: Abre una ventana flotante con dos visualizaciones lado a lado:

Gr√°fico 1 (Barras): Muestra las Ventas Totales por Tipo de Producto para identificar los productos m√°s vendidos.

Gr√°fico 2 (L√≠neas): Muestra la Tendencia de Ventas a lo Largo del Tiempo (por Mes) para identificar estacionalidad o crecimiento.

Siguiente paso: ¬øTe gustar√≠a que implementemos el An√°lisis de Ventas por Regi√≥n para completar el an√°lisis de los datos externos, o tienes alguna otra consulta sobre c√≥mo usar las funciones existentes?


analisis de ventas por region:
Asistente de programaci√≥n
¬°Qu√© fant√°stico plan! Tienes cuatro objetivos muy potentes que llevar√°n tu aplicaci√≥n a un nivel superior.

Para mantener un enfoque claro y garantizar la correcta implementaci√≥n, te sugiero que abordemos estos puntos uno por uno.

Propongo comenzar con el An√°lisis por Regi√≥n, ya que es una extensi√≥n directa del c√≥digo de an√°lisis de datos que acabamos de integrar.

üéØ Nuevo Objetivo: An√°lisis de Ventas por Regi√≥n
Vamos a modificar la funci√≥n analizar_ventas_externas para:

Agrupar las ventas por la columna 'Region' (Norte, Sur, Centro).

Generar un tercer gr√°fico de barras que compare las ventas totales de cada regi√≥n.

Mostrar los tres gr√°ficos (Producto, Temporal, y Regi√≥n) en la misma ventana de Matplotlib usando subplots (tres gr√°ficos en una sola figura).

üìù Modificaci√≥n en cultivos.py (An√°lisis por Regi√≥n)
Por favor, reemplaza el m√©todo analizar_ventas_externas completo en tu clase AppCultivos por el siguiente c√≥digo.

Asistente de programaci√≥n
¬°Qu√© fant√°stico plan! Tienes cuatro objetivos muy potentes que llevar√°n tu aplicaci√≥n a un nivel superior.

Para mantener un enfoque claro y garantizar la correcta implementaci√≥n, te sugiero que abordemos estos puntos uno por uno.

Propongo comenzar con el An√°lisis por Regi√≥n, ya que es una extensi√≥n directa del c√≥digo de an√°lisis de datos que acabamos de integrar.

üéØ Nuevo Objetivo: An√°lisis de Ventas por Regi√≥n
Vamos a modificar la funci√≥n analizar_ventas_externas para:

Agrupar las ventas por la columna 'Region' (Norte, Sur, Centro).

Generar un tercer gr√°fico de barras que compare las ventas totales de cada regi√≥n.

Mostrar los tres gr√°ficos (Producto, Temporal, y Regi√≥n) en la misma ventana de Matplotlib usando subplots (tres gr√°ficos en una sola figura).

üìù Modificaci√≥n en cultivos.py (An√°lisis por Regi√≥n)
Por favor, reemplaza el m√©todo analizar_ventas_externas completo en tu clase AppCultivos por el siguiente c√≥digo.

He ajustado la estructura de Matplotlib para manejar tres subplots en una configuraci√≥n de 1√ó3 (una fila, tres columnas).

def analizar_ventas_externas(self):
        """
        Carga el archivo CSV externo, calcula m√©tricas financieras, y genera tres gr√°ficos:
        Ventas por Producto, Tendencia Temporal, y Ventas por Regi√≥n.
        """
        nombre_archivo = NOMBRE_ARCHIVO_VENTAS
        
        # 1. Carga de Datos y Manejo de Errores
        if not os.path.exists(nombre_archivo):
            messagebox.showwarning("Advertencia", 
                                   f"No se encontr√≥ el archivo de ventas externas '{nombre_archivo}'.\n"
                                   f"Aseg√∫rate de que exista y se llame '{NOMBRE_ARCHIVO_VENTAS}'.")
            return

        try:
            df = pd.read_csv(nombre_archivo, sep=',')
        except pd.errors.ParserError:
            messagebox.showerror("Error", "Error de formato en el CSV. ¬øEs el delimitador correcto (coma)?")
            return
        except Exception as e:
            messagebox.showerror("Error", f"Error inesperado al cargar los datos: {e}")
            return

        # 2. Preparaci√≥n de Datos
        df['Venta_Total'] = pd.to_numeric(df['Venta_Total'], errors='coerce')
        df.dropna(subset=['Venta_Total'], inplace=True)
        
        if df.empty:
            messagebox.showwarning("Advertencia", "El archivo de ventas est√° vac√≠o o solo contiene encabezados v√°lidos.")
            return

        # 3. An√°lisis Agrupado (Ventas por Producto)
        ventas_por_producto = df.groupby('Producto')['Venta_Total'].sum().sort_values(ascending=False)
        
        # 4. An√°lisis Agrupado Temporal (Ventas por Mes)
        mapa_meses = {'Ene': 1, 'Feb': 2, 'Mar': 3, 'Abr': 4, 'May': 5, 'Jun': 6, 
                      'Jul': 7, 'Ago': 8, 'Sep': 9, 'Oct': 10, 'Nov': 11, 'Dic': 12}
        df['Num_Mes'] = df['Mes'].map(mapa_meses)
        ventas_por_mes = df.groupby(['Num_Mes', 'Mes'])['Venta_Total'].sum().reset_index(level=1).sort_values(by='Num_Mes')
        
        
        # --- NUEVO: 5. An√°lisis Agrupado por Regi√≥n ---
        ventas_por_region = df.groupby('Region')['Venta_Total'].sum().sort_values(ascending=False)
        
        print("\n--- REPORTE DE VENTAS POR REGI√ìN ---")
        print(ventas_por_region.to_string())

        
        # --- 6. VISUALIZACI√ìN DE DATOS con Matplotlib (Tres Subplots) ---
        try:
            plt.style.use('dark_background') 
            # Creamos una figura con una fila y tres columnas para los gr√°ficos
            fig, (ax1, ax2, ax3) = plt.subplots(1, 3, figsize=(18, 6))
            fig.suptitle('An√°lisis Detallado de Ventas Externas (Producto, Temporal y Regi√≥n)', color='white', fontsize=16)

            
            # --- Gr√°fico 1: Ventas por Producto (Barras) ---
            ventas_por_producto.plot(kind='bar', color='#1E8449', ax=ax1) 
            ax1.set_title('1. Ventas por Producto', color='white')
            ax1.set_xlabel('Producto', color='white')
            ax1.set_ylabel('Venta Total (‚Ç¨)', color='white')
            ax1.tick_params(axis='x', rotation=45, colors='white')
            ax1.tick_params(axis='y', colors='white')
            ax1.grid(axis='y', linestyle='--', alpha=0.4) 
            
            # --- Gr√°fico 2: Ventas por Mes (L√≠neas) ---
            ax2.plot(ventas_por_mes['Mes'], ventas_por_mes['Venta_Total'], 
                     marker='o', linestyle='-', color='#007BFF', linewidth=3)
            ax2.set_title('2. Tendencia Temporal (Mes)', color='white')
            ax2.set_xlabel('Mes', color='white')
            ax2.set_ylabel('Venta Total (‚Ç¨)', color='white')
            ax2.tick_params(axis='x', rotation=0, colors='white')
            ax2.tick_params(axis='y', colors='white')
            ax2.grid(axis='both', linestyle='--', alpha=0.4) 
            
            # --- Gr√°fico 3: Ventas por Regi√≥n (Barras) ---
            ventas_por_region.plot(kind='bar', color='#FFC107', ax=ax3) 
            ax3.set_title('3. Ventas por Regi√≥n', color='white')
            ax3.set_xlabel('Regi√≥n', color='white')
            ax3.set_ylabel('Venta Total (‚Ç¨)', color='white')
            ax3.tick_params(axis='x', rotation=45, colors='white')
            ax3.tick_params(axis='y', colors='white')
            ax3.grid(axis='y', linestyle='--', alpha=0.4) 

            
            plt.tight_layout(rect=[0, 0.03, 1, 0.95]) 
            messagebox.showinfo("An√°lisis Completo", "Se han generado TRES gr√°ficos de an√°lisis: Producto, Temporal y Regi√≥n.")
            plt.show() 

        except Exception as e:
            messagebox.showerror("Error de Gr√°fico", f"No se pudo generar el gr√°fico: {e}")

Pr√≥ximo Paso
Una vez que reemplaces el c√≥digo y ejecutes la aplicaci√≥n, el bot√≥n "üìà Analizar Ventas Externas" te mostrar√° el reporte completo con los tres enfoques de an√°lisis.

¬øNecesitas el c√≥digo completo de cultivos.py con esta √∫ltima modificaci√≥n, o prefieres pasar directamente a la Predicci√≥n Simple (proyectar ventas futuras)?

A√±adir la Predicci√≥n Simple a tu an√°lisis es un gran salto hacia la inteligencia de datos en tu aplicaci√≥n. Utilizaremos la Regresi√≥n Lineal para proyectar las tendencias futuras.

Para esto, necesitamos introducir una nueva librer√≠a de Python que simplifica la creaci√≥n de modelos de regresi√≥n: scikit-learn (o sklearn).

Requisito Adicional
Si a√∫n no lo tienes instalado, abre tu terminal y ejecuta:
pip install scikit-learn

Modificaci√≥n en cultivos.py (Predicci√≥n Simple)
Vamos a actualizar el m√©todo analizar_ventas_externas en dos pasos:

Nuevo Import: A√±adiremos la clase LinearRegression de sklearn.

Nueva L√≥gica de Predicci√≥n: Entrenaremos el modelo con ventas_por_mes y haremos una predicci√≥n para el siguiente mes.

Visualizaci√≥n: A√±adiremos la l√≠nea de predicci√≥n al gr√°fico de Tendencia Temporal.

Reemplaza la versi√≥n actual de analizar_ventas_externas en tu archivo cultivos.py por el siguiente c√≥digo.

1. Nuevos Imports Necesarios
Aseg√∫rate de que tus imports al inicio de cultivos.py incluyan:

# ... (otros imports)
import pandas as pd
import matplotlib.pyplot as plt
from sklearn.linear_model import LinearRegression # <--- NUEVO IMPORT
import numpy as np # <--- NUEVO IMPORT para manejar arrays

2. C√≥digo del M√©todo analizar_ventas_externas (con Predicci√≥n)
Aqu√≠ est√° el m√©todo completo. Presta especial atenci√≥n a la nueva Secci√≥n 6. Predicci√≥n de Ventas (Regresi√≥n Lineal) y c√≥mo actualiza el Gr√°fico 2.


def analizar_ventas_externas(self):
        """
        Carga el archivo CSV externo, realiza an√°lisis descriptivo, y genera 
        tres gr√°ficos: Producto, Tendencia Temporal (con Predicci√≥n), y Regi√≥n.
        """
        nombre_archivo = NOMBRE_ARCHIVO_VENTAS
        
        # 1. Carga de Datos y Manejo de Errores (Sin cambios)
        if not os.path.exists(nombre_archivo):
            # ... (manejo de error)
            messagebox.showwarning("Advertencia", 
                                   f"No se encontr√≥ el archivo de ventas externas '{nombre_archivo}'.\n"
                                   f"Aseg√∫rate de que exista y se llame '{NOMBRE_ARCHIVO_VENTAS}'.")
            return
        try:
            df = pd.read_csv(nombre_archivo, sep=',')
        except Exception as e:
            # ... (manejo de error)
            messagebox.showerror("Error", f"Error al cargar/formato de datos: {e}")
            return

        # 2. Preparaci√≥n de Datos (Sin cambios)
        df['Venta_Total'] = pd.to_numeric(df['Venta_Total'], errors='coerce')
        df.dropna(subset=['Venta_Total'], inplace=True)
        if df.empty:
            messagebox.showwarning("Advertencia", "El archivo de ventas est√° vac√≠o o solo contiene encabezados v√°lidos.")
            return

        # 3. An√°lisis por Producto (Sin cambios)
        ventas_por_producto = df.groupby('Producto')['Venta_Total'].sum().sort_values(ascending=False)
        
        # 4. An√°lisis Temporal (Preparaci√≥n para Regresi√≥n)
        mapa_meses = {'Ene': 1, 'Feb': 2, 'Mar': 3, 'Abr': 4, 'May': 5, 'Jun': 6, 
                      'Jul': 7, 'Ago': 8, 'Sep': 9, 'Oct': 10, 'Nov': 11, 'Dic': 12}
        df['Num_Mes'] = df['Mes'].map(mapa_meses)
        ventas_por_mes_df = df.groupby(['Num_Mes', 'Mes'])['Venta_Total'].sum().reset_index()
        ventas_por_mes_df = ventas_por_mes_df.sort_values(by='Num_Mes').reset_index(drop=True)
        
        # 5. An√°lisis por Regi√≥n (Sin cambios)
        ventas_por_region = df.groupby('Region')['Venta_Total'].sum().sort_values(ascending=False)
        
        
        # --- NUEVO: 6. PREDICCI√ìN DE VENTAS (REGRESI√ìN LINEAL) ---
        
        # Preparamos los datos para el modelo X (Meses) y Y (Ventas)
        X = ventas_por_mes_df['Num_Mes'].values.reshape(-1, 1) 
        Y = ventas_por_mes_df['Venta_Total'].values
        
        # Creamos y entrenamos el modelo
        modelo_regresion = LinearRegression()
        modelo_regresion.fit(X, Y)
        
        # Hacemos una predicci√≥n para el siguiente mes
        ultimo_mes_num = ventas_por_mes_df['Num_Mes'].max()
        mes_futuro_num = ultimo_mes_num + 1
        
        # Calculamos el nombre del mes futuro para la visualizaci√≥n (Ej: Abr -> May)
        meses_lista = ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic']
        mes_futuro_nombre = meses_lista[mes_futuro_num - 1] if mes_futuro_num <= 12 else f"Mes {mes_futuro_num}"

        # Predecimos la venta para ese mes
        prediccion_futura = modelo_regresion.predict(np.array([[mes_futuro_num]]))[0]
        
        print("\n--- PREDICCI√ìN DE VENTAS ---")
        print(f"Predicci√≥n de venta para {mes_futuro_nombre}: ‚Ç¨{prediccion_futura:.2f}")

        # A√±adimos la predicci√≥n al DataFrame temporal para el gr√°fico
        X_pred = np.append(X, [[mes_futuro_num]], axis=0) # Incluimos el mes futuro
        Y_tendencia = modelo_regresion.predict(X_pred)     # Calculamos toda la l√≠nea de tendencia
        
        # Preparamos las etiquetas del eje X para el gr√°fico
        labels_x = ventas_por_mes_df['Mes'].tolist() + [f"Pred. {mes_futuro_nombre}"]
        
        
        # --- 7. VISUALIZACI√ìN DE DATOS con Matplotlib (Tres Subplots) ---
        try:
            plt.style.use('dark_background') 
            fig, (ax1, ax2, ax3) = plt.subplots(1, 3, figsize=(18, 6))
            fig.suptitle(f'An√°lisis de Ventas (Predicci√≥n {mes_futuro_nombre}: ‚Ç¨{prediccion_futura:.2f})', color='white', fontsize=16)

            
            # --- Gr√°fico 1: Ventas por Producto (Barras) ---
            ventas_por_producto.plot(kind='bar', color='#1E8449', ax=ax1) 
            ax1.set_title('1. Ventas por Producto', color='white')
            # ... (configuraci√≥n de ejes, sin cambios)
            ax1.set_xlabel('Producto', color='white')
            ax1.set_ylabel('Venta Total (‚Ç¨)', color='white')
            ax1.tick_params(axis='x', rotation=45, colors='white')
            ax1.tick_params(axis='y', colors='white')
            ax1.grid(axis='y', linestyle='--', alpha=0.4) 
            
            # --- Gr√°fico 2: Ventas por Mes (L√≠neas con Predicci√≥n) ---
            # Datos Hist√≥ricos
            ax2.plot(ventas_por_mes_df['Mes'], ventas_por_mes_df['Venta_Total'], 
                     marker='o', linestyle='-', color='#007BFF', linewidth=3, label='Ventas Hist√≥ricas')
            # L√≠nea de Tendencia y Predicci√≥n
            ax2.plot(labels_x, Y_tendencia, 
                     linestyle='--', color='#FFC107', linewidth=2, label='Predicci√≥n Lineal')
                     
            ax2.set_title('2. Tendencia Temporal y Predicci√≥n', color='white')
            ax2.set_xlabel('Mes', color='white')
            ax2.set_ylabel('Venta Total (‚Ç¨)', color='white')
            ax2.tick_params(axis='x', rotation=45, colors='white')
            ax2.tick_params(axis='y', colors='white')
            ax2.grid(axis='both', linestyle='--', alpha=0.4) 
            ax2.legend(loc='upper left', frameon=False) 
            
            # --- Gr√°fico 3: Ventas por Regi√≥n (Barras) ---
            ventas_por_region.plot(kind='bar', color='#FFC107', ax=ax3) 
            ax3.set_title('3. Ventas por Regi√≥n', color='white')
            # ... (configuraci√≥n de ejes, sin cambios)
            ax3.set_xlabel('Regi√≥n', color='white')
            ax3.set_ylabel('Venta Total (‚Ç¨)', color='white')
            ax3.tick_params(axis='x', rotation=45, colors='white')
            ax3.tick_params(axis='y', colors='white')
            ax3.grid(axis='y', linestyle='--', alpha=0.4) 

            
            plt.tight_layout(rect=[0, 0.03, 1, 0.95]) 
            messagebox.showinfo("An√°lisis Completo", f"Se han generado tres gr√°ficos, incluyendo una predicci√≥n para {mes_futuro_nombre}.")
            plt.show() 

        except Exception as e:
            messagebox.showerror("Error de Gr√°fico/Predicci√≥n", f"No se pudo generar el gr√°fico o el modelo: {e}")

Pasos para la Implementaci√≥n
Instala Scikit-learn: pip install scikit-learn.

Actualiza Imports: Aseg√∫rate de que el inicio de tu cultivos.py tenga:

# ...
import matplotlib.pyplot as plt
from sklearn.linear_model import LinearRegression 
import numpy as np 
# ...


Reemplaza el M√©todo: Copia el nuevo m√©todo analizar_ventas_externas y reemplaza la versi√≥n anterior en tu cultivos.py.

Una vez que lo ejecutes y presiones "üìà Analizar Ventas Externas", ver√°s una l√≠nea de tendencia en el segundo gr√°fico que se extiende al siguiente mes con la predicci√≥n.

Ahora que tenemos la Predicci√≥n Simple lista, ¬øpasamos a las Alarmas Inteligentes para configurar alertas basadas en el ciclo de vida de los cultivos?






